kernel vec4 maxPlus(sampler image)
{
	vec4 samplerExtent = samplerExtent(image);
	
	vec2 c = samplerCoord(image);
	vec2 cup = c + vec2(0.0, 1.0);
	vec2 cupl = c + vec2(-1.0, 1.0);
	vec2 cupr = c + vec2(1.0, 1.0);
	
	vec4 best = sample(image, cup);
	best = c.x <= samplerExtent.x ? best : max(best, sample(image, cupl));
	best = c.x >= samplerExtent.x + samplerExtent.w ? best : max(best, sample(image, cupr));
	
	vec4 me = sample(image, c);
	return best + me;
}
